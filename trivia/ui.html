<script>
  window.onmessage = async (event) => {
    const msg = event.data.pluginMessage
    const url = event.data.pluginMessage.url
    const res = await fetch(url)
    const json = await res.json()
    if (msg.type === "category") {
      postMessage(json, "category")
    } else if (msg.type === "questions") {
      postMessage(json, "questions")
    }
  };

  function postMessage(response, type) {
    window.parent.postMessage(
        { pluginMessage: { response, type } },
        "*"
      );
  }
</script>
